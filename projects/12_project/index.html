<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Apache Spark Educational | Mehmet Emre Akbulut </title> <meta name="author" content=" "> <meta name="description" content="Educational Apache Spark Project"> <meta name="keywords" content="machine-learning, efficient-ml, tiny-ml, ml-robustness"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/neural-network.png?61e5c4dbf61b7a2b4dc184509fe67049"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://mehmetemreakbulut.github.io/projects/12_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Mehmet Emre Akbulut </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="https://medium.com/@memreakbulut" rel="external nofollow noopener" target="_blank">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">research </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Apache Spark Educational</h1> <p class="post-description">Educational Apache Spark Project</p> </header> <article> <p><a href="https://github.com/mehmetemreakbulut/apache-spark-educational" rel="external nofollow noopener" target="_blank">Github Page</a> <br><br></p> <h3 id="educational-apache-spark-project">Educational Apache Spark Project</h3> <p>This Java code is part of an educational project using Apache Spark to process and analyze educational data. The code is structured to read data from CSV files, perform transformations, and execute both batch and streaming queries. Here’s a detailed explanation of the code:</p> <ol> <li> <p><strong>Package and Imports</strong>: The code begins by declaring the package and importing necessary classes from the Apache Spark library. These imports include classes for Spark SQL, streaming, and data types.</p> </li> <li> <p><strong>Class Declaration</strong>: The main class <code class="language-plaintext highlighter-rouge">SparkGroup38</code> is declared, which contains the main method and other necessary components.</p> </li> <li> <p><strong>Constants</strong>: A constant <code class="language-plaintext highlighter-rouge">numCourses</code> is defined, which is used later in the streaming query.</p> </li> <li> <p><strong>Main Method</strong>: The <code class="language-plaintext highlighter-rouge">main</code> method is the entry point of the application. It accepts command-line arguments for the Spark master URL and the file path.</p> </li> <li> <p><strong>Spark Session Initialization</strong>: A Spark session is created with the specified master URL and application name. The log level is set to “ERROR” to reduce verbosity.</p> </li> <li> <p><strong>Schema Definition</strong>: Schemas for three datasets (<code class="language-plaintext highlighter-rouge">profs</code>, <code class="language-plaintext highlighter-rouge">courses</code>, and <code class="language-plaintext highlighter-rouge">videos</code>) are defined using <code class="language-plaintext highlighter-rouge">StructType</code> and <code class="language-plaintext highlighter-rouge">StructField</code>. These schemas specify the structure of the CSV files to be read.</p> </li> <li> <p><strong>Reading CSV Files</strong>: The code reads three CSV files (<code class="language-plaintext highlighter-rouge">profs.csv</code>, <code class="language-plaintext highlighter-rouge">courses.csv</code>, and <code class="language-plaintext highlighter-rouge">videos.csv</code>) into Spark DataFrames using the defined schemas. The <code class="language-plaintext highlighter-rouge">option</code> method is used to specify that the CSV files do not have headers and use commas as delimiters.</p> </li> <li> <p><strong>Reading Streaming Data</strong>: A streaming DataFrame <code class="language-plaintext highlighter-rouge">visualizations</code> is created using the <code class="language-plaintext highlighter-rouge">rate</code> source, which generates rows at a specified rate (<code class="language-plaintext highlighter-rouge">rowsPerSecond</code>). The <code class="language-plaintext highlighter-rouge">value</code> column is used to simulate video IDs.</p> </li> <li> <strong>Data Transformation and Caching</strong>: <ul> <li> <code class="language-plaintext highlighter-rouge">videosWithCourse</code>: This DataFrame is created by joining the <code class="language-plaintext highlighter-rouge">videos</code> and <code class="language-plaintext highlighter-rouge">courses</code> DataFrames on the <code class="language-plaintext highlighter-rouge">course_name</code> column. It is cached to avoid recomputation in subsequent queries.</li> <li> <code class="language-plaintext highlighter-rouge">profWithCourse</code>: This DataFrame is created by joining the <code class="language-plaintext highlighter-rouge">profs</code> and <code class="language-plaintext highlighter-rouge">courses</code> DataFrames on the <code class="language-plaintext highlighter-rouge">course_name</code> column. It is used only once, so it is not cached.</li> </ul> </li> <li> <p><strong>Query Q1</strong>: This query computes the total number of lecture hours per professor. It groups the <code class="language-plaintext highlighter-rouge">profWithCourse</code> DataFrame by <code class="language-plaintext highlighter-rouge">prof_name</code> and sums the <code class="language-plaintext highlighter-rouge">course_hours</code>. The result is displayed using the <code class="language-plaintext highlighter-rouge">show</code> method.</p> </li> <li> <p><strong>Query Q2</strong>: This streaming query computes the total duration of all visualizations of videos for each course over a minute, updated every 10 seconds. It joins the <code class="language-plaintext highlighter-rouge">visualizations</code> DataFrame with <code class="language-plaintext highlighter-rouge">videosWithCourse</code>, groups by a time window and <code class="language-plaintext highlighter-rouge">course_name</code>, and sums the <code class="language-plaintext highlighter-rouge">video_duration</code>. The result is written to the console in “update” mode.</p> </li> <li> <p><strong>Query Q3</strong>: This streaming query computes the total number of visualizations of each video with respect to the number of students in the course. It joins the <code class="language-plaintext highlighter-rouge">visualizations</code> DataFrame with <code class="language-plaintext highlighter-rouge">videosWithCourse</code>, groups by <code class="language-plaintext highlighter-rouge">video_id</code> and <code class="language-plaintext highlighter-rouge">course_students</code>, counts the visualizations, and computes the ratio of visualizations to students. The result is written to the console in “update” mode.</p> </li> <li> <p><strong>Await Termination</strong>: The code waits for the streaming queries (<code class="language-plaintext highlighter-rouge">q2</code> and <code class="language-plaintext highlighter-rouge">q3</code>) to terminate. If an exception occurs, it is caught and printed.</p> </li> <li> <strong>Spark Session Close</strong>: Finally, the Spark session is closed to release resources.</li> </ol> <p>Overall, this code demonstrates how to use Apache Spark for both batch and streaming data processing in an educational context, providing insights into lecture hours, video visualizations, and student engagement.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 . Mehmet Emre Akbulut </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>